Some test code, comments, and improvement with `https://gist.github.com/Redchards/c5be14c2998f1ca1d757`